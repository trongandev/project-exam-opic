import{c as g,j as e,B as x,C as I,g as P,h as _,i as T,k as z,l as M,m as L,n as $,E as u,S as A,o as E,D as B,a as F,b as H,d as X,e as q,f as p,p as y,q as K,v as f,u as R,r as U,t as N,s as h}from"./index-CBuF9vhA.js";import{L as m,b as o}from"./react-CZ6hAaVq.js";import{S as G}from"./separator-C2LhW6n5.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],O=g("clock",J);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],V=g("pen",Q);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Y=g("settings",W);function Z({currentPage:s,totalPages:r,onPageChange:d}){const c=i=>{i>=1&&i<=r&&d(i)},a=()=>{const i=[];for(let t=1;t<=r;t++)i.push(e.jsx(x,{variant:t===s?"default":"outline",onClick:()=>c(t),className:t===s?" text-white":"",children:t},t));return i};return r<=1?null:e.jsxs("div",{className:"flex flex-col items-center gap-4 mt-10",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(x,{variant:"outline",onClick:()=>c(s-1),disabled:s===1,children:"Previous"}),a(),e.jsx(x,{variant:"outline",onClick:()=>c(s+1),disabled:s===r,children:"Next"})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Trang ",s," / ",r||1]})]})}function ee({topic:s,idUser:r,loadingDelete:d,handleDeleteTopic:c}){return e.jsxs(I,{className:"bg-white border-primary/20 hover:shadow-lg shadow-primary/10 transition-all duration-300 relative group",children:[e.jsx(P,{className:"",children:e.jsx("div",{className:"flex items-center gap-3 justify-between",children:e.jsxs("div",{className:"",children:[e.jsx(_,{className:"text-xl font-semibold text-gray-900 flex-1",children:s.name}),e.jsx("p",{className:"text-gray-500 text-sm line-clamp-3",children:s.desc})]})})}),e.jsx(G,{}),e.jsxs(T,{children:[e.jsxs("div",{className:"mb-5",children:[e.jsx("p",{children:"Các chủ đề có trong topic:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s.data.map(a=>e.jsx(z,{variant:"secondary",className:"mr-2 mb-2",children:a.categoryId.title},a._id))})]}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx(m,{to:`/profile/${s.userId._id}`,children:e.jsx(M,{user:s.userId})}),e.jsxs("div",{className:"flex items-center justify-between gap-5 w-full text-gray-500",children:[e.jsxs("div",{className:"w-full  ",children:[e.jsx("h1",{className:"font-medium text-gray-700",children:s.userId.displayName}),e.jsxs("div",{className:"flex gap-2 items-center text-xs",title:`Ngày tạo: ${$(new Date(s.createdAt),"PPPP",{locale:f})}`,children:[e.jsx(O,{size:14})," ",L(new Date(s.createdAt),new Date,{addSuffix:!0,locale:f})]})]}),e.jsxs("div",{className:"text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 flex-1",children:[e.jsx(u,{size:14})," ",s.viewCount]}),e.jsxs("div",{className:"flex items-center gap-1 flex-1 ",children:[e.jsx(A,{size:14,className:"fill-yellow-500 stroke-yellow-500"}),e.jsx("p",{children:s.rating.length>0?s.rating.reduce((a,i)=>a+i.score,0)/s.rating.length:"5.0"}),e.jsx("p",{children:s.rating.length?`(${s.rating.length})`:""})]})]})]})]})]}),e.jsxs(E,{className:"gap-2",children:[e.jsx(m,{to:`/topic/${s.slug}`,className:"block w-full",children:e.jsxs(x,{className:"w-full bg-primary hover:bg-primary/90 text-white group-hover:shadow-md transition-all",children:[e.jsx(u,{}),"Xem chi tiết"]})}),r===s.userId._id&&e.jsxs(B,{children:[e.jsx(F,{children:e.jsx(x,{variant:"outline",children:e.jsx(Y,{})})}),e.jsxs(H,{children:[e.jsx(X,{children:"Tính năng"}),e.jsx(q,{}),e.jsx(m,{to:`edit-topic/${s._id}`,children:e.jsxs(p,{children:[e.jsx(V,{}),"Chỉnh sửa"]})}),e.jsx(p,{variant:"destructive",onClick:()=>c(s._id),disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsx(y,{}),"Đang xóa..."]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{}),"Xóa"]})})]})]})]})]},s._id)}function ne(){const[s,r]=o.useState([]),[d,c]=o.useState(!1),[a,i]=o.useState({currentPage:1,totalPages:1,pageSize:6,totalItems:0}),[t,v]=o.useState(1),[w,j]=o.useState(!1),{user:C}=R();o.useEffect(()=>{(async()=>{c(!0);try{const l=await N.getAllTopics(t,a.pageSize);r(l.data.data),i({currentPage:l.data.pagination.currentPage,totalPages:l.data.pagination.totalPages,pageSize:l.data.pagination.pageSize,totalItems:l.data.pagination.totalItems})}catch(l){console.error("Error fetching topics:",l),h.error("Không thể tải dữ liệu")}finally{c(!1)}})()},[t]);const b=n=>{n!==t&&n>=1&&n<=a.totalPages&&v(n)},k=async n=>{try{j(!0);const l=await N.deleteTopic(n);h.success(l.data.message),r(D=>D.filter(S=>S._id!==n))}catch(l){h.error(l?.message)}finally{j(!1)}};return e.jsxs("div",{className:"px-4 xl:px-0 max-w-7xl mx-auto my-20 min-h-screen",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:["Tổng hợp topic",a.totalItems>0&&e.jsxs("span",{className:"text-lg font-normal text-gray-600",children:["(",a.totalItems," topic",a.totalItems>1?"s":"",")"]})]}),e.jsx("p",{className:"text-gray-600",children:"Tham khảo các topic mà người dùng đóng góp hoặc bấm vào nút ở dưới để"}),e.jsx(m,{to:"/topic/create-topic",children:e.jsxs(x,{className:"mt-2",children:[e.jsx(U,{})," Đóng góp topic"]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:d?e.jsx("div",{className:"flex items-center justify-center h-[500px] col-span-full",children:e.jsx(y,{})}):s.length>0?s.map(n=>e.jsx(ee,{topic:n,idUser:C?._id,loadingDelete:w,handleDeleteTopic:k},n._id)):e.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] col-span-full text-gray-500",children:[e.jsx("p",{className:"text-lg font-medium mb-2",children:"Chưa có topic nào"}),e.jsx("p",{className:"text-sm",children:"Hãy là người đầu tiên đóng góp topic!"})]})}),e.jsx(Z,{currentPage:t,totalPages:a.totalPages,onPageChange:b})]})}export{ne as default};
